var htmlTemplates=htmlTemplates||{};htmlTemplates["tiles.html"]='<header class=tile-header>\n	<a class=tile-author>\n		<% if (profile_image_url) { %>\n			<img class=tile-author-avatar src="<%=profile_image_url%>" alt="<%=name%>\'s avatar">\n		<% } %>\n		<strong class=tile-author-name><%=name%></strong>\n	</a>\n	<span class=tile-actions>\n		<span class="icon icon-<%=type%>"></span>\n	</span>\n</header>\n<div class=tile-content>\n	<% if (media_url) { %>\n		<img class=tile-media src="<%=media_url%>" alt="<%=text%>" title="<%=text%>">\n	<% } else { %>\n		<%=text%>\n	<% } %>\n</div>\n<footer class=tile-footer>\n	<p class="tile-share float-left">\n		<a href=#>\n			<span class="icon icon-mini icon-twitter"></span>\n		</a>\n		<a href=#>\n			<span class="icon icon-mini icon-facebook"></span>\n		</a>\n		<a href=#>\n			<span class="icon icon-mini icon-pinterest"></span>\n		</a>\n		<a href=#>\n			<span class="icon icon-mini icon-envelope"></span>\n		</a>\n	<p class=float-right>\n		<time is=relative-time datetime="<%=time%>">\n			<%=time%>\n		</time>\n		<!--<a target=_blank href="<%=link%>">view post</a>-->\n</footer>\n';var MicroEvent=function(){};MicroEvent.prototype={bind:function(n,t){this._events=this._events||{},this._events[n]=this._events[n]||[],this._events[n].push(t)},unbind:function(n,t){this._events=this._events||{},n in this._events!=!1&&this._events[n].splice(this._events[n].indexOf(t),1)},trigger:function(n){if(this._events=this._events||{},n in this._events!=!1)for(var t=0;t<this._events[n].length;t++)this._events[n][t].apply(this,Array.prototype.slice.call(arguments,1))}},MicroEvent.mixin=function(n){for(var t=["bind","unbind","trigger"],e=0;e<t.length;e++)"function"==typeof n?n.prototype[t[e]]=MicroEvent.prototype[t[e]]:n[t[e]]=MicroEvent.prototype[t[e]]},"undefined"!=typeof module&&"exports"in module&&(module.exports=MicroEvent),function(){var n={};this.tmpl=function t(e,i){var s=/\W/.test(e)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+e.replace(/[\r\t\n]/g," ").split("<%").join("	").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("	").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):n[e]=n[e]||t(document.getElementById(e).innerHTML);return i?s(i):s}}(),!function(){function n(n){function t(s){function o(){d3.json(n+"/"+s,function(n,e){t.trigger(s,e[s])})}return o(),i=setInterval(o,e),this}var e=3e4,i=null;return t.host=function(t){return arguments.length?(n=t,this):n},t.stop=function(){return clearInterval(i),this},t.pollRate=function(n){return arguments.length?(e=n,this):e},_.assign(t,MicroEvent.prototype)}function t(n){function t(s){return e=io.connect(n,{"force new connection":!0}),i=e.socket,i.on("connect",function(){e.emit("ready","posts"==s?"default":path)}),i.on("connect_failed",function(){console.error("connection failed")}),i.on("error",function(){console.error("connection error")}),e.on("recvData",function(n){t.trigger(s,JSON.parse(n))}),this}var e=null,i=null;return t.host=function(t){return arguments.length?(n=t,this):n},t.stop=function(){e&&e.disconnect()},_.assign(t,MicroEvent.prototype)}function e(){function n(e){return t.forEach(function(t){t.bind(e,function(t){n.trigger(e,t)}),t(e)}),this}var t=[];return n.stream=function(n){return t.push(n),this},n.stop=function(){return t.forEach(function(n){n.stop()}),this},_.assign(n,MicroEvent.prototype)}function i(n){function t(n){return _.isArray(n)?n.forEach(function(n){_.contains(r,n)||r.push(n)}):_.contains(r,post)||r.push(post),a.length&&(r=_.compose(a[0])(r)),i=i.data(r),i.enter().append("div").style("opacity",0),i.attr("class",function(n){return"tile tile-"+n.type+(n.media_url?" tile-has-media":"")}).html(function(n){return e(new s(n))}).transition().duration(1e3).style("opacity",1),i.exit().transition().duration(750).style("opacity",0).remove(),this}var e=tmpl(htmlTemplates["tiles.html"]),i=d3.select(n).selectAll("div"),o=null,r=[],a=[];return t.stream=function(n){return arguments.length?(o=n,o("posts"),o.bind("posts",function(n){_.isArray(n)?r=n:_.contains(r,n)||r.push(n),t(r)}),t):o},t.posts=function(n){return arguments.length?(r=n,this):r},t.filter=function(n){a.push(n),t(r)},t.sort=function(n,e){t.filter(function(t){return t=_.sortBy(t,n),e?t.reverse():t})},t}function s(n){_.assign(this,s.defaults,n)}s.defaults={profile_image_url:null,media_url:null},this.nio={json:n,socketio:t,mux:e,tiles:i}}();
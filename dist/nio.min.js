var htmlTemplates=htmlTemplates||{};htmlTemplates["tiles/tiles.html"]='<header class=tile-header>\n	<a class=tile-author>\n		<% if (profile_image_url) { %>\n			<img class=tile-author-avatar src="<%=profile_image_url%>" alt="<%=name%>\'s avatar">\n		<% } %>\n		<strong class=tile-author-name><%=name%></strong>\n	</a>\n	<span class=tile-actions>\n		<span class="icon icon-<%=type%>"></span>\n	</span>\n</header>\n<div class=tile-content>\n	<% if (media_url) { %>\n		<img class=tile-media src="<%=media_url%>" alt="<%=text%>" title="<%=text%>">\n	<% } else { %>\n		<%=linkify(truncate(text, 150))%>\n	<% } %>\n</div>\n<footer class=tile-footer>\n	<p class="tile-share float-left">\n		<a href=#>\n			<span class="icon icon-mini icon-twitter"></span>\n		</a>\n		<a href=#>\n			<span class="icon icon-mini icon-facebook"></span>\n		</a>\n		<a href=#>\n			<span class="icon icon-mini icon-pinterest"></span>\n		</a>\n		<a href=#>\n			<span class="icon icon-mini icon-envelope"></span>\n		</a>\n	<p class=float-right>\n		<time is=relative-time datetime="<%=time%>">\n			<%=time%>\n		</time>\n		<!--<a target=_blank href="<%=link%>">view post</a>-->\n</footer>\n',function t(n,e,i){function r(o,a){if(!e[o]){if(!n[o]){var u="function"==typeof require&&require;if(!a&&u)return u(o,!0);if(s)return s(o,!0);throw new Error("Cannot find module '"+o+"'")}var c=e[o]={exports:{}};n[o][0].call(c.exports,function(t){var e=n[o][1][t];return r(e?e:t)},c,c.exports,t,n,e,i)}return e[o].exports}for(var s="function"==typeof require&&require,o=0;o<i.length;o++)r(i[o]);return r}({1:[function(t,n,e){var i=function(){function t(){}return t.prototype.on=function(t,n){this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(n)},t.prototype.off=function(t,n){this._events=this._events||{},t in this._events!=!1&&this._events[t].splice(this._events[t].indexOf(n),1)},t.prototype.emit=function(t){for(var n=[],e=0;e<arguments.length-1;e++)n[e]=arguments[e+1];if(this._events=this._events||{},t in this._events!=!1)for(var i=0;i<this._events[t].length;i++)this._events[t][i].apply(this,n)},t}();e.EventEmitter=i},{}],2:[function(t){function n(){return s.make(function(t){console.log(t),this.push(t)})}var e,i=this.__extends||function(t,n){function e(){this.constructor=t}for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i]);e.prototype=n.prototype,t.prototype=new e},r=t("./models"),s=t("./stream"),o=t("./tiles/tiles"),a=function(t){function n(n,e){"undefined"==typeof e&&(e=2e4),this.host=n,this.pollRate=e,t.call(this)}return i(n,t),n.prototype.fetch=function(t){var n=this;this.path=t,d3.json(this.host+"/"+t,function(e,i){var r=i[t];if(r&&_.isArray(r))for(var s=r.length;s--;)n.push(r[s]);else n.push(r)})},n.prototype.start=function(t){var n=this;return this.fetch(t),this.interval=setInterval(function(){return n.fetch(t)},this.pollRate),this},n.prototype.pause=function(){clearTimeout(this.interval)},n.prototype.resume=function(){this.start(this.path)},n}(s.Stream),u=function(t){function n(n){this.host=n,t.call(this)}return i(n,t),n.prototype.start=function(t){var n=this.ws=io.connect(this.host),e=n.socket;return t="posts"==t?"default":t,e.on("connect",function(){return n.emit("ready",t)}),e.on("connect_failed",function(){return console.error("connection failed")}),e.on("error",function(){return console.error("connection error")}),this.resume(),this},n.prototype.pause=function(){this.ws.on("recvData",function(){return null})},n.prototype.resume=function(){var t=this;this.ws.on("recvData",function(n){return t.push(JSON.parse(n))})},n}(s.Stream),c=(function(t){function n(){for(var n=[],e=0;e<arguments.length-0;e++)n[e]=arguments[e+0];this.sources=n,t.call(this)}return i(n,t),n.prototype.start=function(t){return this.sources.forEach(function(n){return n.start(t)}),this},n.prototype.pause=function(){this.sources.forEach(function(t){return t.pause()})},n.prototype.resume=function(){this.sources.forEach(function(t){return t.resume()})},n}(s.Stream),function(t){function n(n,e){"undefined"==typeof n&&(n="hello world"),"undefined"==typeof e&&(e=1e3);var i=this;setInterval(function(){return i.push(n)},e),t.call(this)}return i(n,t),n}(s.Stream),function(t){function n(n){this.modelFn=n,this.data=[],this.transforms=[],this.transformFn=null,t.call(this)}return i(n,t),n.prototype.write=function(t){var n=new this.modelFn(t);_.any(this.data,function(t){return n.getID()==t.getID()})||(this.data.push(n),this.transformFn&&(this.data=this.transformFn(this.data)),this.push(this.data))},n.prototype.transform=function(t){return this.transforms.push(t),this.transformFn=this.transforms[0],this},n.prototype.sort=function(t,n){return this.transform(function(e){var i=_.sortBy(e,function(n){return n[t]});return n?i.reverse():i}),this},n}(s.Stream));!function(t){function e(t,n){return new a(t,n)}function i(t){return new u(t)}function s(t){return new c(t)}function l(t,e){var i=new o.TileView(t),s=new c(r.Post);return s.sort("time",!0),e.start("posts").pipe(s).pipe(n()).pipe(i),i}t.json=e,t.socketio=i,t.collection=s,t.showTiles=l}(e||(e={})),window.nio=e},{"./models":3,"./stream":4,"./tiles/tiles":5}],3:[function(t,n,e){var i=function(){function t(t){this.name=null,this.text=null,this.type=null,this.id=null,this.link=null,this.time=null,this.alt_text=null,this.priority="0",this.sensitive=!1,this.profile_image_url=null,this.media_url=null,_.assign(this,t)}return t.prototype.getID=function(){return this.id},t}();e.Post=i},{}],4:[function(t,n,e){function i(t){var n=new o;return n.write=t.bind(n),n}var r=this.__extends||function(t,n){function e(){this.constructor=t}for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i]);e.prototype=n.prototype,t.prototype=new e},s=t("./events"),o=function(t){function n(){t.apply(this,arguments)}return r(n,t),n.prototype.push=function(t){this.emit("data",t)},n.prototype.write=function(){this.emit("error",new Error("not implemented"))},n.prototype.pipe=function(t){return this.on("data",t.write.bind(t)),t},n}(s.EventEmitter);e.Stream=o,e.make=i},{"./events":1}],5:[function(t,n,e){var i=this.__extends||function(t,n){function e(){this.constructor=t}for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i]);e.prototype=n.prototype,t.prototype=new e},r=t("../stream"),s=t("../utils"),o=_.template(htmlTemplates["tiles/tiles.html"],null,{imports:{linkify:s.linkify,truncate:s.truncate}}),a=function(t){function n(n){this.el=d3.select(n),this.posts=[],this.lazyRender=_.debounce(this.render.bind(this),1e3),t.call(this)}return i(n,t),n.prototype.render=function(){var t=this.el.selectAll("div").data(this.posts);t.enter().append("div"),t.attr("class",function(t){return"tile tile-"+t.type+(t.media_url?" tile-has-media":"")}).html(function(t){return o(t)}),t.exit()},n.prototype.write=function(t){this.posts=t,this.lazyRender(),this.push(this.posts)},n}(r.Stream);e.TileView=a},{"../stream":4,"../utils":6}],6:[function(t,n,e){function i(t){return t=t.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi,"<a target=_blank href='$1'>$1</a>"),t=t.replace(/(^|\s)@(\w+)/g,'$1<a target=_blank href="http://twitter.com/$2">@$2</a>'),t.replace(/(^|\s)#(\w+)/g,'$1<a target=_blank href="http://twitter.com/search?q=%23$2">#$2</a>')}function r(t,n){var e=new XMLHttpRequest;e.open("GET",t,!0),e.onload=function(){e.status>=200&&e.status<400?n(JSON.parse(e.responseText),null):n(null,e)},e.onerror=function(){return n(null,e)},e.send()}function s(t,n){return t.length>n?t.substring(0,n-3)+"...":t}e.linkify=i,e.json=r,e.truncate=s},{}]},{},[2]);